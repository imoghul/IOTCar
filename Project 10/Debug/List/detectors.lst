###############################################################################
#
# IAR C/C++ Compiler V7.21.1.1000/W32 for MSP430          17/Apr/2022  16:57:06
# Copyright 1996-2021 IAR Systems AB.
# PC-locked license - IAR Embedded Workbench for MSP430, 8K KickStart Edition 7.21
#
#    __rt_version  =  3
#    __double_size =  32
#    __reg_r4      =  free
#    __reg_r5      =  free
#    __pic         =  no
#    __core        =  430X
#    __data_model  =  small
#    __code_model  =  large
#    Source file   =  C:\Users\saad\Documents\ece-306\Project 10\detectors.c
#    Command line  =  
#        -f C:\Users\saad\AppData\Local\Temp\EW2B84.tmp
#        ("C:\Users\saad\Documents\ece-306\Project 10\detectors.c" -lC
#        "C:\Users\saad\Documents\ece-306\Project 10\Debug\List" -o
#        "C:\Users\saad\Documents\ece-306\Project 10\Debug\Obj" --debug
#        -D__MSP430FR2355__ -e --double=32 --dlib_config "C:\Program Files\IAR
#        Systems\Embedded Workbench 8.5\430\lib\dlib\dl430xlsfn.h" -I ./
#        --core=430X --data_model=small -Ohz --multiplier=32
#        --hw_workaround=CPU40 --code_model=large)
#    Locale        =  English_USA.1252
#    List file     =  
#        C:\Users\saad\Documents\ece-306\Project 10\Debug\List\detectors.lst
#    Object file   =  
#        C:\Users\saad\Documents\ece-306\Project 10\Debug\Obj\detectors.r43
#
###############################################################################

C:\Users\saad\Documents\ece-306\Project 10\detectors.c
      1          #include "msp430.h"
      2          #include "ports.h"
      3          #include "adc.h"
      4          #include "wheels.h"
      5          #include <string.h>
      6          #include "sm.h"
      7          #include "detectors.h"
      8          extern volatile unsigned char display_changed;
      9          extern char display_line[4][11];

   \                                 In  segment DATA16_Z, align 1, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     10          char movingDirection;
   \                     movingDirection:
   \   000000                DS8 1

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     11          int rightVals[VALUES_TO_HOLD];
   \                     rightVals:
   \   000000                DS8 8
     12          extern volatile unsigned int ADC_Left_Detect, ADC_Right_Detect;

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     13          int lastLeft;
   \                     lastLeft:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     14          int lastRight;
   \                     lastRight:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     15          int leftVals[VALUES_TO_HOLD];
   \                     leftVals:
   \   000000                DS8 8
     16          extern volatile unsigned int adcUpdated;
     17          extern volatile unsigned int calibrationMode;

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     18          unsigned int LBDetect, LWDetect, RBDetect, RWDetect;
   \                     LBDetect:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     LWDetect:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     RBDetect:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     RWDetect:
   \   000000                DS8 2
     19          

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     20          short l_LessBlack,l_LessGray,l_LessWhite;
   \                     l_LessBlack:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     l_LessGray:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     l_LessWhite:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     21          short r_LessBlack,r_LessGray,r_LessWhite;
   \                     r_LessBlack:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     r_LessGray:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     r_LessWhite:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     22          short l_GreaterBlack,l_GreaterGray,l_GreaterWhite;
   \                     l_GreaterBlack:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     l_GreaterGray:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     l_GreaterWhite:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     23          short r_GreaterBlack,r_GreaterGray,r_GreaterWhite;
   \                     r_GreaterBlack:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     r_GreaterGray:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     r_GreaterWhite:
   \   000000                DS8 2
     24          short lessWhiteOr,lessWhiteAnd,greaterWhiteOr,greaterWhiteAnd;

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     25          short lessWhiteOr,lessWhiteAnd,greaterWhiteOr,greaterWhiteAnd;
   \                     lessWhiteOr:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     lessWhiteAnd:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     greaterWhiteOr:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     greaterWhiteAnd:
   \   000000                DS8 2
     26          short lessGrayOr,lessGrayAnd,greaterGrayOr,greaterGrayAnd;

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     27          short lessGrayOr,lessGrayAnd,greaterGrayOr,greaterGrayAnd;
   \                     lessGrayOr:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     lessGrayAnd:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     greaterGrayOr:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     greaterGrayAnd:
   \   000000                DS8 2
     28          short lessBlackOr,lessBlackAnd,greaterBlackOr,greaterBlackAnd;

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     29          short lessBlackOr,lessBlackAnd,greaterBlackOr,greaterBlackAnd;
   \                     lessBlackOr:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     lessBlackAnd:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     greaterBlackOr:
   \   000000                DS8 2

   \                                 In  segment DATA16_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
   \                     greaterBlackAnd:
   \   000000                DS8 2
     30          

   \                                 In  segment CODE, align 2
     31          void updateDetectors(void){
   \                     updateDetectors:
   \   000000   3B15         PUSHM.W #0x4, R11
   \   000002   1842....     MOV.W   &LBDetect, R8
   \   000006   2883         SUB.W   #0x2, R8
   \   000008   8298....     CMP.W   R8, &ADC_Left_Detect
   \   00000C   4F7F         SUBC.B  R15, R15
   \   00000E   5FF3         AND.B   #0x1, R15
   \   000010   824F....     MOV.W   R15, &l_LessBlack
   \   000014   1B42....     MOV.W   &RBDetect, R11
   \   000018   2B83         SUB.W   #0x2, R11
   \   00001A   829B....     CMP.W   R11, &ADC_Right_Detect
   \   00001E   4F7F         SUBC.B  R15, R15
   \   000020   5FF3         AND.B   #0x1, R15
   \   000022   824F....     MOV.W   R15, &r_LessBlack
   \   000026   1C42....     MOV.W   &LBDetect, R12
   \   00002A   3C50F6FF     ADD.W   #0xfff6, R12
   \   00002E   829C....     CMP.W   R12, &ADC_Left_Detect
   \   000032   4F7F         SUBC.B  R15, R15
   \   000034   5FF3         AND.B   #0x1, R15
   \   000036   824F....     MOV.W   R15, &l_LessGray
     32            l_LessBlack = ADC_Left_Detect<LEFT_BLACK_DETECT;
     33            r_LessBlack = ADC_Right_Detect<RIGHT_BLACK_DETECT;
     34            l_LessGray = ADC_Left_Detect<LEFT_GRAY_DETECT;
     35            r_LessGray = ADC_Right_Detect<RIGHT_GRAY_DETECT;
   \   00003A   1E42....     MOV.W   &RBDetect, R14
   \   00003E   3E50F6FF     ADD.W   #0xfff6, R14
   \   000042   829E....     CMP.W   R14, &ADC_Right_Detect
   \   000046   4F7F         SUBC.B  R15, R15
   \   000048   5FF3         AND.B   #0x1, R15
   \   00004A   824F....     MOV.W   R15, &r_LessGray
     36            l_LessWhite = ADC_Left_Detect<LEFT_WHITE_DETECT;
   \   00004E   1D42....     MOV.W   &LWDetect, R13
   \   000052   2D53         ADD.W   #0x2, R13
   \   000054   829D....     CMP.W   R13, &ADC_Left_Detect
   \   000058   4F7F         SUBC.B  R15, R15
   \   00005A   5FF3         AND.B   #0x1, R15
   \   00005C   824F....     MOV.W   R15, &l_LessWhite
     37            r_LessWhite = ADC_Right_Detect<RIGHT_WHITE_DETECT;
   \   000060   1A42....     MOV.W   &RWDetect, R10
   \   000064   2A53         ADD.W   #0x2, R10
   \   000066   829A....     CMP.W   R10, &ADC_Right_Detect
   \   00006A   4F7F         SUBC.B  R15, R15
   \   00006C   5FF3         AND.B   #0x1, R15
   \   00006E   824F....     MOV.W   R15, &r_LessWhite
     38            //
     39            l_GreaterBlack = ADC_Left_Detect>LEFT_BLACK_DETECT;
   \   000072   1892....     CMP.W   &ADC_Left_Detect, R8
   \   000076   4F7F         SUBC.B  R15, R15
   \   000078   5FF3         AND.B   #0x1, R15
   \   00007A   824F....     MOV.W   R15, &l_GreaterBlack
     40            r_GreaterBlack = ADC_Right_Detect>RIGHT_BLACK_DETECT;
   \   00007E   1B92....     CMP.W   &ADC_Right_Detect, R11
   \   000082   4F7F         SUBC.B  R15, R15
   \   000084   5FF3         AND.B   #0x1, R15
   \   000086   824F....     MOV.W   R15, &r_GreaterBlack
     41            l_GreaterGray = ADC_Left_Detect>LEFT_GRAY_DETECT;
   \   00008A   1C92....     CMP.W   &ADC_Left_Detect, R12
   \   00008E   4F7F         SUBC.B  R15, R15
   \   000090   5FF3         AND.B   #0x1, R15
   \   000092   824F....     MOV.W   R15, &l_GreaterGray
     42            r_GreaterGray = ADC_Right_Detect>RIGHT_GRAY_DETECT;
   \   000096   1E92....     CMP.W   &ADC_Right_Detect, R14
   \   00009A   4F7F         SUBC.B  R15, R15
   \   00009C   5FF3         AND.B   #0x1, R15
   \   00009E   824F....     MOV.W   R15, &r_GreaterGray
     43            l_GreaterWhite = ADC_Left_Detect>LEFT_WHITE_DETECT;
   \   0000A2   1D92....     CMP.W   &ADC_Left_Detect, R13
   \   0000A6   4F7F         SUBC.B  R15, R15
   \   0000A8   5FF3         AND.B   #0x1, R15
   \   0000AA   824F....     MOV.W   R15, &l_GreaterWhite
     44            r_GreaterWhite = ADC_Right_Detect>RIGHT_WHITE_DETECT;
   \   0000AE   1A92....     CMP.W   &ADC_Right_Detect, R10
   \   0000B2   4F7F         SUBC.B  R15, R15
   \   0000B4   5FF3         AND.B   #0x1, R15
   \   0000B6   824F....     MOV.W   R15, &r_GreaterWhite
     45            //
     46            
     47          }
   \   0000BA   3817         POPM.W  #0x4, R11
   \   0000BC   1001         RETA
     48          

   \                                 In  segment CODE, align 2
     49          void calibrate(void) {
   \                     calibrate:
   \   000000   1B15         PUSHM.W #0x2, R11
     50            unsigned int left = ADC_Left_Detect, right = ADC_Right_Detect;
   \   000002   1A42....     MOV.W   &ADC_Left_Detect, R10
   \   000006   1B42....     MOV.W   &ADC_Right_Detect, R11
     51              if(calibrationMode == 0) {
   \   00000A   8293....     CMP.W   #0x0, &calibrationMode
   \   00000E   0B20         JNE     ??calibrate_1
     52          
     53                  if (left > LBDetect) LBDetect = left;
   \   000010   829A....     CMP.W   R10, &LBDetect
   \   000014   022C         JC      ??calibrate_2
   \   000016   824A....     MOV.W   R10, &LBDetect
     54          
     55                  if (right > RBDetect) RBDetect = right;
   \                     ??calibrate_2:
   \   00001A   829B....     CMP.W   R11, &RBDetect
   \   00001E   102C         JC      ??calibrate_0
   \   000020   824B....     MOV.W   R11, &RBDetect
   \   000024   0D3C         JMP     ??calibrate_0
     56              } else if(calibrationMode == 1) {
   \                     ??calibrate_1:
   \   000026   9293....     CMP.W   #0x1, &calibrationMode
   \   00002A   0A20         JNE     ??calibrate_0
     57                  
     58          
     59                  if (left > LWDetect) LWDetect = left;
   \   00002C   829A....     CMP.W   R10, &LWDetect
   \   000030   022C         JC      ??calibrate_3
   \   000032   824A....     MOV.W   R10, &LWDetect
     60          
     61                  if (right > RWDetect) RWDetect = right;
   \                     ??calibrate_3:
   \   000036   829B....     CMP.W   R11, &RWDetect
   \   00003A   022C         JC      ??calibrate_0
   \   00003C   824B....     MOV.W   R11, &RWDetect
     62              }
     63          
     64              HEXtoBCD((int)LBDetect, 3, 6);
                     ^
Warning[Pe223]: function "HEXtoBCD" declared implicitly
   \                     ??calibrate_0:
   \   000040   3E400600     MOV.W   #0x6, R14
   \   000044   3D400300     MOV.W   #0x3, R13
   \   000048   1C42....     MOV.W   &LBDetect, R12
   \   00004C   ........     CALLA   #HEXtoBCD
     65              HEXtoBCD((int)RBDetect, 3, 0);
   \   000050   0E43         MOV.W   #0x0, R14
   \   000052   3D400300     MOV.W   #0x3, R13
   \   000056   1C42....     MOV.W   &RBDetect, R12
   \   00005A   ........     CALLA   #HEXtoBCD
     66              HEXtoBCD((int)LWDetect, 2, 6);
   \   00005E   3E400600     MOV.W   #0x6, R14
   \   000062   2D43         MOV.W   #0x2, R13
   \   000064   1C42....     MOV.W   &LWDetect, R12
   \   000068   ........     CALLA   #HEXtoBCD
     67              HEXtoBCD((int)RWDetect, 2, 0);
   \   00006C   0E43         MOV.W   #0x0, R14
   \   00006E   2D43         MOV.W   #0x2, R13
   \   000070   1C42....     MOV.W   &RWDetect, R12
   \   000074   ........     CALLA   #HEXtoBCD
     68              HEXtoBCD((int)left, 0, 6);
   \   000078   3E400600     MOV.W   #0x6, R14
   \   00007C   0D43         MOV.W   #0x0, R13
   \   00007E   0C4A         MOV.W   R10, R12
   \   000080   ........     CALLA   #HEXtoBCD
     69              HEXtoBCD((int)right, 0, 0);
   \   000084   0E43         MOV.W   #0x0, R14
   \   000086   0D43         MOV.W   #0x0, R13
   \   000088   0C4B         MOV.W   R11, R12
   \   00008A   ........     CALLA   #HEXtoBCD
     70              
     71          }
   \   00008E   1A17         POPM.W  #0x2, R11
   \   000090   1001         RETA

   Maximum stack usage in bytes:

   CSTACK Function
   ------ --------
      8   calibrate
        8   -> HEXtoBCD
     12   updateDetectors


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
       2  LBDetect
       2  LWDetect
       2  RBDetect
       2  RWDetect
     146  calibrate
       2  greaterBlackAnd
       2  greaterBlackOr
       2  greaterGrayAnd
       2  greaterGrayOr
       2  greaterWhiteAnd
       2  greaterWhiteOr
       2  l_GreaterBlack
       2  l_GreaterGray
       2  l_GreaterWhite
       2  l_LessBlack
       2  l_LessGray
       2  l_LessWhite
       2  lastLeft
       2  lastRight
       8  leftVals
       2  lessBlackAnd
       2  lessBlackOr
       2  lessGrayAnd
       2  lessGrayOr
       2  lessWhiteAnd
       2  lessWhiteOr
       1  movingDirection
       2  r_GreaterBlack
       2  r_GreaterGray
       2  r_GreaterWhite
       2  r_LessBlack
       2  r_LessGray
       2  r_LessWhite
       8  rightVals
     190  updateDetectors

 
 336 bytes in segment CODE
  77 bytes in segment DATA16_Z
 
 336 bytes of CODE memory
  77 bytes of DATA memory

Errors: none
Warnings: 1
