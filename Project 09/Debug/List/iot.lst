###############################################################################
#
# IAR C/C++ Compiler V7.21.1.1000/W32 for MSP430          04/Apr/2022  10:47:09
# Copyright 1996-2021 IAR Systems AB.
# PC-locked license - IAR Embedded Workbench for MSP430, 8K KickStart Edition 7.21
#
#    __rt_version  =  3
#    __double_size =  32
#    __reg_r4      =  free
#    __reg_r5      =  free
#    __pic         =  no
#    __core        =  430X
#    __data_model  =  small
#    __code_model  =  large
#    Source file   =  C:\Users\saad\Documents\ece-306\Project 09\iot.c
#    Command line  =  
#        -f C:\Users\saad\AppData\Local\Temp\EWB3AB.tmp
#        ("C:\Users\saad\Documents\ece-306\Project 09\iot.c" -lC
#        "C:\Users\saad\Documents\ece-306\Project 09\Debug\List" -o
#        "C:\Users\saad\Documents\ece-306\Project 09\Debug\Obj" --no_cse
#        --no_unroll --no_inline --no_code_motion --no_tbaa --debug
#        -D__MSP430FR2355__ -e --double=32 --dlib_config "C:\Program Files\IAR
#        Systems\Embedded Workbench 8.5\430\lib\dlib\dl430xlsfn.h" -I ./
#        --core=430X --data_model=small -On --multiplier=32
#        --hw_workaround=CPU40 --code_model=large)
#    Locale        =  English_USA.1252
#    List file     =  
#        C:\Users\saad\Documents\ece-306\Project 09\Debug\List\iot.lst
#    Object file   =  
#        C:\Users\saad\Documents\ece-306\Project 09\Debug\Obj\iot.r43
#
###############################################################################

C:\Users\saad\Documents\ece-306\Project 09\iot.c
      1          #include "iot.h"
      2          #include "msp430.h"

   \                                 In  segment DATA16_AN, at 0x51a
   \   union <unnamed> _A_UCA0IE_L
   \                     _A_UCA0IE_L:
   \   000000                DS8 2
      3          #include <string.h>
      4          #include "serial.h"
      5          

   \                                 In  segment DATA16_I, align 1, align-sorted
   \   000000                REQUIRE ?cstart_init_copy
      6          char iot_setup_state = BOOT_UP;
   \                     iot_setup_state:
   \   000000                DS8 1
   \   000001                REQUIRE `?<Initializer for iot_setup_state>`
      7          extern volatile char USB0_Char_Tx[];
      8          extern unsigned volatile int pb0_buffered;
      9          extern volatile char USB0_Char_Rx_Process[];
     10          extern volatile char receievedFromPC;

   \                                 In  segment DATA16_Z, align 1, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     11          char SSID[SSID_LEN+1];
   \                     SSID:
   \   000000                DS8 11

   \                                 In  segment DATA16_Z, align 1, align-sorted
   \   000000                REQUIRE ?cstart_init_zero
     12          char IP[IP_LEN+1];
   \                     IP:
   \   000000                DS8 14
     13          extern volatile unsigned char display_changed;
     14          extern char display_line[4][11];
     15          
     16          

   \                                 In  segment CODE, align 2
     17          int Init_IOT(void){
   \                     Init_IOT:
   \   000000   0A12         PUSH.W  R10
     18            //if(!receievedFromPC) return;
     19            
     20            switch(iot_setup_state){
   \   000002   5E42....     MOV.B   &iot_setup_state, R14
   \   000006   7E804200     SUB.B   #0x42, R14
   \   00000A   1524         JEQ     ??Init_IOT_18
   \   00000C   7E800700     SUB.B   #0x7, R14
   \   000010   AA24         JEQ     ??Init_IOT_19
   \   000012   6E82         SUB.B   #0x4, R14
   \   000014   2124         JEQ     ??Init_IOT_20
   \   000016   5E83         SUB.B   #0x1, R14
   \   000018   6724         JEQ     ??Init_IOT_21
   \   00001A   7E800500     SUB.B   #0x5, R14
   \   00001E   4024         JEQ     ??Init_IOT_22
   \   000020   7E801600     SUB.B   #0x16, R14
   \   000024   AC24         JEQ     ??Init_IOT_23
   \   000026   6E82         SUB.B   #0x4, R14
   \   000028   2324         JEQ     ??Init_IOT_24
   \   00002A   5E83         SUB.B   #0x1, R14
   \   00002C   6924         JEQ     ??Init_IOT_25
   \   00002E   7E800500     SUB.B   #0x5, R14
   \   000032   4224         JEQ     ??Init_IOT_26
   \   000034   CF3C         JMP     ??Init_IOT_12
     21              case BOOT_UP:
     22                if(pb0_buffered){
   \                     ??Init_IOT_18:
   \   000036   8293....     CMP.W   #0x0, &pb0_buffered
   \   00003A   CE24         JEQ     ??Init_IOT_3
     23                  if(strcmp((char*)USB0_Char_Rx_Process,BOOT_RESPONSE) == 0){
   \   00003C   3D40....     MOV.W   #`?<Constant "WIFI GOT IP\\r\\n">`, R13
   \   000040   3C40....     MOV.W   #USB0_Char_Rx_Process, R12
   \   000044   ........     CALLA   #strcmp
   \   000048   0C93         CMP.W   #0x0, R12
   \   00004A   0320         JNE     ??Init_IOT_27
     24                    iot_setup_state=CIPMUX_Tx;
   \   00004C   F2404D00.... MOV.B   #0x4d, &iot_setup_state
     25                  }
     26                clearProcessBuff_0();
   \                     ??Init_IOT_27:
   \   000052   ........     CALLA   #clearProcessBuff_0
     27                }
     28                break;
   \   000056   C03C         JMP     ??Init_IOT_3
     29                
     30              case CIPMUX_Tx:
     31                strcpy((char*)USB0_Char_Tx,ALLOW_MULTIPLE_CONNECTIONS);
   \                     ??Init_IOT_20:
   \   000058   3D40....     MOV.W   #`?<Constant "AT+CIPMUX=1\\r\\n">`, R13
   \   00005C   3C40....     MOV.W   #USB0_Char_Tx, R12
   \   000060   ........     CALLA   #strcpy
     32                USCI_A0_transmit();
   \   000064   ........     CALLA   #USCI_A0_transmit
     33                iot_setup_state = CIPMUX_Rx;
   \   000068   F2406D00.... MOV.B   #0x6d, &iot_setup_state
     34                break;
   \   00006E   B43C         JMP     ??Init_IOT_3
     35              case CIPMUX_Rx:
     36                if(UCA0IE & UCTXIE) break; // wait for the Tx to completely transmit
   \                     ??Init_IOT_24:
   \   000070   A2B31A05     BIT.W   #0x2, &0x51a
   \   000074   B12C         JC      ??Init_IOT_3
     37                if(pb0_buffered){ // wait for pb to finish buffering
   \   000076   8293....     CMP.W   #0x0, &pb0_buffered
   \   00007A   AE24         JEQ     ??Init_IOT_3
     38                  if(strcmp((char*)USB0_Char_Rx_Process,OK_RESPONSE) == 0) { //  check if the response was "OK"
   \   00007C   3D40....     MOV.W   #`?<Constant "OK\\r\\n">`, R13
   \   000080   3C40....     MOV.W   #USB0_Char_Rx_Process, R12
   \   000084   ........     CALLA   #strcmp
   \   000088   0C93         CMP.W   #0x0, R12
   \   00008A   0420         JNE     ??Init_IOT_28
     39                    iot_setup_state = CIPSERVER_Tx;
   \   00008C   F2405300.... MOV.B   #0x53, &iot_setup_state
   \   000092   033C         JMP     ??Init_IOT_13
     40                  }
     41                  else iot_setup_state = CIPMUX_Tx;
   \                     ??Init_IOT_28:
   \   000094   F2404D00.... MOV.B   #0x4d, &iot_setup_state
     42                  clearProcessBuff_0();
   \                     ??Init_IOT_13:
   \   00009A   ........     CALLA   #clearProcessBuff_0
     43                }
     44                break;
   \   00009E   9C3C         JMP     ??Init_IOT_3
     45                
     46              case CIPSERVER_Tx:
     47                strcpy((char*)USB0_Char_Tx,START_SERVER);
   \                     ??Init_IOT_22:
   \   0000A0   3D40....     MOV.W   #`?<Constant "AT+CIPSERVER=1,4666\\r\\n">`, R13
   \   0000A4   3C40....     MOV.W   #USB0_Char_Tx, R12
   \   0000A8   ........     CALLA   #strcpy
     48                USCI_A0_transmit();
   \   0000AC   ........     CALLA   #USCI_A0_transmit
     49                iot_setup_state = CIPSERVER_Rx;
   \   0000B0   F2407300.... MOV.B   #0x73, &iot_setup_state
     50                break;
   \   0000B6   903C         JMP     ??Init_IOT_3
     51              case CIPSERVER_Rx:
     52                if(UCA0IE & UCTXIE) break;
   \                     ??Init_IOT_26:
   \   0000B8   A2B31A05     BIT.W   #0x2, &0x51a
   \   0000BC   8D2C         JC      ??Init_IOT_3
     53                if(pb0_buffered){
   \   0000BE   8293....     CMP.W   #0x0, &pb0_buffered
   \   0000C2   8A24         JEQ     ??Init_IOT_3
     54                  if(strcmp((char*)USB0_Char_Rx_Process,OK_RESPONSE) == 0) {
   \   0000C4   3D40....     MOV.W   #`?<Constant "OK\\r\\n">`, R13
   \   0000C8   3C40....     MOV.W   #USB0_Char_Rx_Process, R12
   \   0000CC   ........     CALLA   #strcmp
   \   0000D0   0C93         CMP.W   #0x0, R12
   \   0000D2   0420         JNE     ??Init_IOT_29
     55                    iot_setup_state = GET_SSID_Tx;
   \   0000D4   F2404E00.... MOV.B   #0x4e, &iot_setup_state
   \   0000DA   033C         JMP     ??Init_IOT_14
     56                  }
     57                  else iot_setup_state = CIPSERVER_Tx;
   \                     ??Init_IOT_29:
   \   0000DC   F2405300.... MOV.B   #0x53, &iot_setup_state
     58                  clearProcessBuff_0();
   \                     ??Init_IOT_14:
   \   0000E2   ........     CALLA   #clearProcessBuff_0
     59                }
     60                break;
   \   0000E6   783C         JMP     ??Init_IOT_3
     61                
     62              case GET_SSID_Tx:
     63                strcpy((char*)USB0_Char_Tx,SSID_COMMAND);
   \                     ??Init_IOT_21:
   \   0000E8   3D40....     MOV.W   #`?<Constant "AT+CWJAP?\\r\\n">`, R13
   \   0000EC   3C40....     MOV.W   #USB0_Char_Tx, R12
   \   0000F0   ........     CALLA   #strcpy
     64                USCI_A0_transmit();
   \   0000F4   ........     CALLA   #USCI_A0_transmit
     65                iot_setup_state = GET_SSID_Rx;
   \   0000F8   F2406E00.... MOV.B   #0x6e, &iot_setup_state
     66                break;
   \   0000FE   6C3C         JMP     ??Init_IOT_3
     67              case GET_SSID_Rx:
     68                if(UCA0IE & UCTXIE) break;
   \                     ??Init_IOT_25:
   \   000100   A2B31A05     BIT.W   #0x2, &0x51a
   \   000104   692C         JC      ??Init_IOT_3
     69                if(pb0_buffered){
   \   000106   8293....     CMP.W   #0x0, &pb0_buffered
   \   00010A   6624         JEQ     ??Init_IOT_3
     70                  if(strncmp(SSID_RESPONSE,(char*)USB0_Char_Rx_Process,SSID_RESPONSE_LEN) == 0) {
   \   00010C   3E400700     MOV.W   #0x7, R14
   \   000110   3D40....     MOV.W   #USB0_Char_Rx_Process, R13
   \   000114   3C40....     MOV.W   #`?<Constant "+CWJAP:">`, R12
   \   000118   ........     CALLA   #strncmp
   \   00011C   0C93         CMP.W   #0x0, R12
   \   00011E   1D20         JNE     ??Init_IOT_30
     71                    int i;
     72                    for(i = 0;i<=SSID_LEN && USB0_Char_Rx_Process[i+SSID_RESPONSE_LEN+1]!='\"';++i) SSID[i] = USB0_Char_Rx_Process[i+SSID_RESPONSE_LEN+1];
   \   000120   0A43         MOV.W   #0x0, R10
   \                     ??Init_IOT_0:
   \   000122   3A900B00     CMP.W   #0xb, R10
   \   000126   0934         JGE     ??Init_IOT_31
   \   000128   FA902200.... CMP.B   #0x22, LWRD(USB0_Char_Rx_Process + 8)(R10)
   \   00012E   0524         JEQ     ??Init_IOT_31
   \   000130   DA4A........ MOV.B   LWRD(USB0_Char_Rx_Process + 8)(R10), SSID(R10)
   \   000136   1A53         ADD.W   #0x1, R10
   \   000138   F43F         JMP     ??Init_IOT_0
     73                    SSID[i+SSID_RESPONSE_LEN+2] = 0;
   \                     ??Init_IOT_31:
   \   00013A   CA43....     MOV.B   #0x0, SSID + 9(R10)
     74                    SSID[SSID_LEN] = 0;
   \   00013E   C243....     MOV.B   #0x0, &SSID + 10
     75                    strcpy(display_line[0],SSID);
   \   000142   3D40....     MOV.W   #SSID, R13
   \   000146   3C40....     MOV.W   #display_line, R12
   \   00014A   ........     CALLA   #strcpy
     76                    display_changed = 1;
   \   00014E   D243....     MOV.B   #0x1, &display_changed
     77                    iot_setup_state = GET_IP_Tx;
   \   000152   F2404900.... MOV.B   #0x49, &iot_setup_state
   \   000158   033C         JMP     ??Init_IOT_15
     78                  }
     79                  else iot_setup_state = GET_SSID_Tx;
   \                     ??Init_IOT_30:
   \   00015A   F2404E00.... MOV.B   #0x4e, &iot_setup_state
     80                  clearProcessBuff_0();
   \                     ??Init_IOT_15:
   \   000160   ........     CALLA   #clearProcessBuff_0
     81                }
     82                break;
   \   000164   393C         JMP     ??Init_IOT_3
     83                
     84               case GET_IP_Tx:
     85                strcpy((char*)USB0_Char_Tx,IP_COMMAND);
   \                     ??Init_IOT_19:
   \   000166   3D40....     MOV.W   #`?<Constant "AT+CIFSR\\r\\n">`, R13
   \   00016A   3C40....     MOV.W   #USB0_Char_Tx, R12
   \   00016E   ........     CALLA   #strcpy
     86                USCI_A0_transmit();
   \   000172   ........     CALLA   #USCI_A0_transmit
     87                iot_setup_state = GET_IP_Rx;
   \   000176   F2406900.... MOV.B   #0x69, &iot_setup_state
     88                break;
   \   00017C   2D3C         JMP     ??Init_IOT_3
     89              case GET_IP_Rx:
     90                if(UCA0IE & UCTXIE) break;
   \                     ??Init_IOT_23:
   \   00017E   A2B31A05     BIT.W   #0x2, &0x51a
   \   000182   2A2C         JC      ??Init_IOT_3
     91                if(pb0_buffered){
   \   000184   8293....     CMP.W   #0x0, &pb0_buffered
   \   000188   2724         JEQ     ??Init_IOT_3
     92                  if(strncmp(IP_RESPONSE,(char*)USB0_Char_Rx_Process,IP_RESPONSE_LEN) == 0) {
   \   00018A   3E400D00     MOV.W   #0xd, R14
   \   00018E   3D40....     MOV.W   #USB0_Char_Rx_Process, R13
   \   000192   3C40....     MOV.W   #`?<Constant "+CIFSR:STAIP,">`, R12
   \   000196   ........     CALLA   #strncmp
   \   00019A   0C93         CMP.W   #0x0, R12
   \   00019C   1520         JNE     ??Init_IOT_32
     93                    int i;
     94                    for(i = 0;i<=IP_LEN && USB0_Char_Rx_Process[i+IP_RESPONSE_LEN+1]!='"';++i) IP[i] = USB0_Char_Rx_Process[i+IP_RESPONSE_LEN+1];
   \   00019E   0F43         MOV.W   #0x0, R15
   \                     ??Init_IOT_1:
   \   0001A0   3F900E00     CMP.W   #0xe, R15
   \   0001A4   0934         JGE     ??Init_IOT_33
   \   0001A6   FF902200.... CMP.B   #0x22, LWRD(USB0_Char_Rx_Process + 14)(R15)
   \   0001AC   0524         JEQ     ??Init_IOT_33
   \   0001AE   DF4F........ MOV.B   LWRD(USB0_Char_Rx_Process + 14)(R15), IP(R15)
   \   0001B4   1F53         ADD.W   #0x1, R15
   \   0001B6   F43F         JMP     ??Init_IOT_1
     95                    IP[i+IP_RESPONSE_LEN+2] = 0;
   \                     ??Init_IOT_33:
   \   0001B8   CF43....     MOV.B   #0x0, LWRD(IP + 15)(R15)
     96                    IP[IP_LEN] = 0;
   \   0001BC   C243....     MOV.B   #0x0, &IP + 13
     97                    //strcpy(display_line[1],IP);
     98                    //display_changed = 1;
     99                    iot_setup_state = IOT_SETUP_FINISHED;
   \   0001C0   F2404600.... MOV.B   #0x46, &iot_setup_state
   \   0001C6   033C         JMP     ??Init_IOT_16
    100                  }
    101                  else iot_setup_state = GET_IP_Tx;
   \                     ??Init_IOT_32:
   \   0001C8   F2404900.... MOV.B   #0x49, &iot_setup_state
    102                  clearProcessBuff_0();
   \                     ??Init_IOT_16:
   \   0001CE   ........     CALLA   #clearProcessBuff_0
    103                }
    104                break;
   \   0001D2   023C         JMP     ??Init_IOT_3
    105              
    106              default:
    107                return 1;
   \                     ??Init_IOT_12:
   \   0001D4   1C43         MOV.W   #0x1, R12
   \   0001D6   013C         JMP     ??Init_IOT_17
    108                break;
    109            }
    110            return 0;
   \                     ??Init_IOT_3:
   \   0001D8   0C43         MOV.W   #0x0, R12
   \                     ??Init_IOT_17:
   \   0001DA   3A41         POP.W   R10
   \   0001DC   1001         RETA
   \   0001DE                REQUIRE _A_UCA0IE_L
    111          }

   \                                 In  segment DATA16_ID, align 1, align-sorted
   \                     `?<Initializer for iot_setup_state>`:
   \   000000   42           DC8 66

   \                                 In  segment DATA16_C, align 1, align-sorted
   \                     `?<Constant "WIFI GOT IP\\r\\n">`:
   \   000000   574946492047 DC8 "WIFI GOT IP\015\012"
   \            4F542049500D
   \            0A00        

   \                                 In  segment DATA16_C, align 1, align-sorted
   \                     `?<Constant "AT+CIPMUX=1\\r\\n">`:
   \   000000   41542B434950 DC8 "AT+CIPMUX=1\015\012"
   \            4D55583D310D
   \            0A00        

   \                                 In  segment DATA16_C, align 1, align-sorted
   \                     `?<Constant "OK\\r\\n">`:
   \   000000   4F4B0D0A00   DC8 "OK\015\012"

   \                                 In  segment DATA16_C, align 1, align-sorted
   \                     `?<Constant "AT+CIPSERVER=1,4666\\r\\n">`:
   \   000000   41542B434950 DC8 "AT+CIPSERVER=1,4666\015\012"
   \            534552564552
   \            3D312C343636
   \            360D0A00    

   \                                 In  segment DATA16_C, align 1, align-sorted
   \                     `?<Constant "AT+CWJAP?\\r\\n">`:
   \   000000   41542B43574A DC8 "AT+CWJAP?\015\012"
   \            41503F0D0A00

   \                                 In  segment DATA16_C, align 1, align-sorted
   \                     `?<Constant "+CWJAP:">`:
   \   000000   2B43574A4150 DC8 "+CWJAP:"
   \            3A00        

   \                                 In  segment DATA16_C, align 1, align-sorted
   \                     `?<Constant "AT+CIFSR\\r\\n">`:
   \   000000   41542B434946 DC8 "AT+CIFSR\015\012"
   \            53520D0A00  

   \                                 In  segment DATA16_C, align 1, align-sorted
   \                     `?<Constant "+CIFSR:STAIP,">`:
   \   000000   2B4349465352 DC8 "+CIFSR:STAIP,"
   \            3A5354414950
   \            2C00        

   Maximum stack usage in bytes:

   CSTACK Function
   ------ --------
      6   Init_IOT
        6   -> USCI_A0_transmit
        6   -> clearProcessBuff_0
        6   -> strcmp
        6   -> strcpy
        6   -> strncmp


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
      14  ?<Constant "+CIFSR:STAIP,">
       8  ?<Constant "+CWJAP:">
      11  ?<Constant "AT+CIFSR\r\n">
      14  ?<Constant "AT+CIPMUX=1\r\n">
      22  ?<Constant "AT+CIPSERVER=1,4666\r\n">
      12  ?<Constant "AT+CWJAP?\r\n">
       5  ?<Constant "OK\r\n">
      14  ?<Constant "WIFI GOT IP\r\n">
       1  ?<Initializer for iot_setup_state>
      14  IP
     478  Init_IOT
      11  SSID
       2  _A_UCA0IE_L
       1  iot_setup_state

 
 478 bytes in segment CODE
   2 bytes in segment DATA16_AN
 100 bytes in segment DATA16_C
   1 byte  in segment DATA16_I
   1 byte  in segment DATA16_ID
  25 bytes in segment DATA16_Z
 
 478 bytes of CODE  memory
 101 bytes of CONST memory
  26 bytes of DATA  memory (+ 2 bytes shared)

Errors: none
Warnings: none
